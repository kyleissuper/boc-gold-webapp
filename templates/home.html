<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Bank of China | Gold</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="{{ url_for('static', filename='favicon.ico') }}" rel="icon" type="image/x-icon" />
    <link href="https://fonts.googleapis.com/css?family=Oxygen:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <style>
      body, .top, .bottom, header, section, .group, .group * {
        box-sizing: border-box;
      }
      @media (min-width: 550px) {
        body {
          position: absolute;
          width: 534px;
          left: 50%;
          margin-left: -267px;
        }
      }
      body {
        padding: 0 10px;
        font-family: 'Roboto', sans-serif;
        background: #f2f2f2;
      }
      strong {
        font-weight: 700;
      }
      body, a {
        color: #535353;
        font-size: 13px;
      }
      a {
        text-decoration: underline;
      }
      .top a {
        font-size: 12px;
      }
      .top {
        font-size: 12px;
        text-align: right;
        padding: 10px 0 10px 0;
      }
      .bottom {
        border-top: 2px solid #d3d3d3;
        margin-top: 20px;
        padding: 10px 20px;
        line-height: 30px;
      }
      header, section {
        border: 1px solid #dadada;
        border-radius: 5px;
        background: #fff;
        box-shadow: 0 2px 26px #eeeeee;
        padding: 1.5em;
        margin-bottom: 15px;
      }
      #search_url {
        width: Calc(100% - 40px);
      }
      #search_icon {
        cursor: pointer;
        margin-top: 15px;
      }
    </style>
  </head>
  <body>
    <div class="top">
      <a href="https://bschool.nus.edu.sg/news-hub/press-release/news/3511">BOC-NUS Hackathon 2018</a> | <a href="https://kyletan.me">Kyle Tan</a>
    </div>
    <header>
      <a href="/">
        <img src="{{ url_for('static', filename='images/logo.png') }}" height=40 />
      </a>
    </header>
    {% if data["type"] is none %}
      <section>
        <p class="input-field">
            <input type="text" id="search_url" class="autocomplete" autofocus>
            <label for="search_url">Find deals by pasting website URL</label>
            <i class="material-icons right" id="search_icon">search</i>
        </p>
		  	<p><strong>OR</strong></p>
        <p id="search_nearby">
          <button class="btn waves-effect waves-light">
            Find deals with my location
            <i class="material-icons right">location_on</i>
          </button>
        </p>
      </section>
    {% elif data["results"]|length == 0 %}
      <section>
        Sorry, we couldn't find any results for that search. Try selecting one of the pre-populated results in the search bar below?
      </section>
      <section>
        <p class="input-field">
            <input type="text" id="search_url" class="autocomplete" autofocus>
            <label for="search_url">Find deals by pasting website URL</label>
            <i class="material-icons right" id="search_icon">search</i>
        </p>
		  	<p><strong>OR</strong></p>
        <p id="search_nearby">
          <button class="btn waves-effect waves-light">
            Find deals with my location
            <i class="material-icons right">location_on</i>
          </button>
        </p>
      </section>
    {% else %}
      <section>
        <a href="/">Click to return to search page</a>
      </section>
    {% endif %}
    <section>
      <h5>What is BOC Gold?</h5>
      <p>BOC Gold is a prototype solution that shows you Bank of China exclusive deals. Simply paste the URL of the website you are on, or find deals using your location.</p>
      <p>This solution was built for a <a href="https://bschool.nus.edu.sg/news-hub/press-release/news/3511">24 Hour Hackathon</a> hosted by the National University of Singapore Business School and sponsored by Bank of China (Singapore).</p>
    </section>
    <div class="bottom">
      &copy;
      <script type="text/javascript">
        let d = new Date()
        document.write(d.getFullYear())
      </script> <a href="http://www.bankofchina.com/sg">BOC (Singapore)</a> and <a href="http://nus.edu.sg/">NUS</a>.
      <img src="{{ url_for('static', filename='images/logo.png') }}" height="30px" style="float: right" />
    </div>
    <script type="text/javascript">
      let submit_url;
      document.querySelector("#search_url").addEventListener("keyup", function(event) {
        event.preventDefault();
        if (event.keyCode === 13) {
          submit_url = "/?url=" + this.value;
          window.location.replace(submit_url);
        }
      });
      document.querySelector("#search_icon").addEventListener("click", function(event) {
        submit_url = "/?url=" + document.querySelector("#search_url").value;
        window.location.replace(submit_url);
      });
      function showPosition(position) {
        submit_url = "/?latitude=" + position.coords.latitude;
        submit_url = submit_url + "&longitude=" + position.coords.longitude;
        window.location.replace(submit_url);
      }
      function getLocation() {
          if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(showPosition);
          } else { 
              x.innerHTML = "Geolocation is not supported by this browser.";
          }
      }
      document.querySelector("#search_nearby").addEventListener("click", function() {
        getLocation();
      });
		  let options = {
        minLength: 0,
        onAutocomplete: function() {
          submit_url = "/?url=" + document.querySelector("#search_url").value;
          window.location.replace(submit_url);
        },
        data: {
          "Apple": null,
          "Microsoft": null,
          "Google": 'https://placehold.it/250x250'
        },
      };
      document.addEventListener('DOMContentLoaded', function() {
        var elems = document.querySelectorAll('.autocomplete');
        var instances = M.Autocomplete.init(elems, options);
      });
    </script>
  </body>
</html>
